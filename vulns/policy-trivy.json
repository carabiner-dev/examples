{
    "id": "OSPS",
    "meta": {
        "runtime": "cel@v0",
        "description": "Trivy vulnerability scanning policy set",
        "version": 1,
        "enforce": "true"
    },
    "common": {
        "identities": [],
        "references": [],
        "context": {}
    },
    "policies": [
        {
            "id": "AC-07",
            "meta": {
                "description": "The project's version control system MUST require multi-factor authentication that does not include SMS ",
                "runtime": "cel@v0",
                "assert_mode": "AND",
                "version": 1,
                "enforce": "true",
                "controls": [
                    {
                        "id": "OSPS-VM-02",
                        "class": "OSPS",
                        "framework": "OSPS",
                        "title": "Vulnerability Management"
                    }
                ]
            },
            "identities": [
                {
                    "id": "google-adolfo",
                    "sigstore": {
                        "mode": "exact",
                        "issuer": "https://accounts.google.com",
                        "identity": "adolfo.garcia@uservers.net"
                    }
                }
            ],
            "tenets": [
                {
                    "runtime": "cel@v0",
                    "code": "size(predicates) > 0",
                    "predicates": {
                        "types": ["https://trivy.dev/report"]
                    }
                },
                {
                    "runtime": "cel@v0",
                    "code": "outputs[\"critical\"] == 0",
                    "predicates": {
                        "types": ["https://trivy.dev/report"]
                    },
                    "outputs": {
                        "critical": {
                            "code": "size(predicates[0].data.Results[0].Vulnerabilities.filter(vuln, vuln.Severity == \"CRITICAL\"))"
                        },
                        "high": {
                            "code": "size(predicates[0].data.Results[0].Vulnerabilities.filter(vuln, vuln.Severity == \"HIGH\"))"
                        }
                    }
                }
            ]
        }
    ]
}
