{
    "id": "oss-rebuild-sbom",
    "common": {
        "context": {
            "packages": {
                "required": true,
                "default": [
                    "@adobe/lit-mobx","@apidevtools/swagger-parser","@codemirror/commands","@codemirror/lang-json","@codemirror/lang-python","@codemirror/legacy-modes","@codemirror/lint","@codemirror/search","@codemirror/state",
                    "@doubletrade/lit-datatable","@emmetio/math-expression","@emmetio/stream-reader-utils","@fastify/static","@fluidnext-polymer/paper-autocomplete","@fortawesome/fontawesome-svg-core",
                    "@fortawesome/free-brands-svg-icons","@fortawesome/free-regular-svg-icons","@fortawesome/free-solid-svg-icons","@fortawesome/react-fontawesome","@fortawesome/vue-fontawesome","@google-web-components/google-apis",
                    "@google-web-components/google-chart","@google-web-components/google-youtube","@googlemaps/js-api-loader","@iobroker/adapter-core","@lezer/common","@lezer/highlight","@lezer/json","@lezer/lr","@lezer/python",
                    "@ngx-translate/core","@noble/curves","@noble/hashes","@polymer/app-layout","@polymer/app-route","@polymer/app-storage","@polymer/decorators","@polymer/font-roboto","@polymer/iron-a11y-announcer",
                    "@polymer/iron-a11y-keys-behavior","@polymer/iron-a11y-keys","@polymer/iron-ajax","@polymer/iron-autogrow-textarea","@polymer/iron-behaviors","@polymer/iron-checked-element-behavior",
                    "@polymer/iron-collapse","@polymer/iron-demo-helpers","@polymer/iron-dropdown","@polymer/iron-fit-behavior","@polymer/iron-flex-layout","@polymer/iron-form-element-behavior","@polymer/iron-form",
                    "@polymer/iron-icon","@polymer/iron-icons","@polymer/iron-iconset-svg","@polymer/iron-iconset","@polymer/iron-image","@polymer/iron-input","@polymer/iron-jsonp-library","@polymer/iron-label","@polymer/iron-list",
                    "@polymer/iron-localstorage","@polymer/iron-location","@polymer/iron-media-query","@polymer/iron-menu-behavior","@polymer/iron-meta","@polymer/iron-overlay-behavior","@polymer/iron-pages",
                    "@polymer/iron-range-behavior","@polymer/iron-resizable-behavior","@polymer/iron-scroll-target-behavior","@polymer/iron-scroll-threshold","@polymer/iron-selector","@polymer/iron-validatable-behavior",
                    "@polymer/iron-validator-behavior","@polymer/marked-element","@polymer/neon-animation","@polymer/paper-badge","@polymer/paper-behaviors","@polymer/paper-button","@polymer/paper-card","@polymer/paper-checkbox",
                    "@polymer/paper-dialog-behavior","@polymer/paper-dialog-scrollable","@polymer/paper-dialog","@polymer/paper-drawer-panel","@polymer/paper-dropdown-menu","@polymer/paper-header-panel",
                    "@polymer/paper-icon-button","@polymer/paper-input","@polymer/paper-item","@polymer/paper-listbox","@polymer/paper-material","@polymer/paper-menu-button","@polymer/paper-progress","@polymer/paper-radio-button",
                    "@polymer/paper-radio-group","@polymer/paper-ripple","@polymer/paper-slider","@polymer/paper-spinner","@polymer/paper-styles","@polymer/paper-swatch-picker","@polymer/paper-tabs","@polymer/paper-toast","@polymer/paper-toggle-button",
                    "@polymer/paper-toolbar","@polymer/paper-tooltip","@polymer/prism-element","@primer/behaviors","@replit/codemirror-indentation-markers","@testing-library/jest-dom","@vscode/webview-ui-toolkit","@whatwg-node/fetch",
                    "@xmldom/xmldom","JSONStream","abbrev","accepts","accounting","ace-builds","acorn-jsx","add","adm-zip","aes-js","aggregate-error","almond","amqplib","analytics-node","angular-cache","angular-drag-and-drop-lists","angular-hotkeys",
                    "angular-loading-bar","angular-markdown-directive","angular-material-data-table","angular-native-dragdrop","angular-tour","angularfire","animate.css","animejs","ansi-colors","ansi-escapes","ansi-regex","ansi-styles","ansi","anymatch",
                    "app-module-path","app-root-path","archiver","arg","argparse","array-tree-filter","arrify","assert-plus","assert","async-lock","async-mqtt","async-retry","async","at-least-node","atob","auto-bind","aws-lambda","aws4","babel-eslint",
                    "babel-helper-vue-jsx-merge-props","babel-plugin-angularjs-annotate","babel-plugin-named-asset-import","babel-preset-react-app","babelify","backoff","balanced-match","basic-auth","bcrypt","bech32","better-sqlite3","bfj","bindings",
                    "bip39","blakejs","blessed","bn.js","body-parser","boom","bootstrap-sass","bootstrap","bottleneck","bowser","boxen","brace-expansion","brace","braces","browserify","bs58","bs58check","btoa","buffer-crc32","buffer-from","buffer",
                    "builtin-modules","bullmq","bulma","bunyan","bytes","cache-manager","callsites","camelcase-keys","camelcase","cannon","canvas","canvg","case-sensitive-paths-webpack-plugin","case","caseless","chai-as-promised","chai",
                    "chalk","chance","change-case","chart.js","check-node-version","cheerio","chokidar","ci-info","circular-dependency-plugin","classnames","clean-css","clean-deep","clean-webpack-plugin","clear","cli-color","cli-cursor",
                    "cli-spinner","cli-spinners","cli-table","cli-table3","cli-truncate","clipboardy","clone-deep","cls-hooked","clui","co","code-formlly","codemirror","coffee-script","color-convert","color-pale-generatorly","color-parse","color-string","color",
                    "color_generator_complex","colors","colorthief","command-exists","command-line-args","command-line-usage","commander","comment-json","commonmark","compare-versions","compressible","compressing","compression","concat-stream",
                    "conf","config","configstore","connect-flash","connect-history-api-fallback","connect-redis","connect","constants-browserify","content-disposition","content-type","convert-source-map","cookie-parser","cookie-session","cookie",
                    "cookies","copy-to-clipboard","copyfiles","core-js","core-util-is","cors","cos-nodejs-sdk-v5","create-hash","create-hmac","cron-parser","cross-env","cross-fetch","cross-spawn","crypto-js","crypto-random-string","css-loader","css","csurf",
                    "custom-event","cytoscape-dagre","d","d3-tip","d3.chart","dagre-d3","dagre","data-urls","data-visualizer-csv","datamaps","datatables","dateformat","debounce","debug","decamelize","decode-uri-component","decompress","deep-assign",
                    "deep-copy","deep-diff","deep-equal","deep-extend","del","delay","delayed-stream","delegates","depd","dependency-graph","destroy","detect-indent","detect-node","detect-port","dialog-polyfill","diff-match-patch","discord.js","dockerode",
                    "doctrine","document-register-element","dompurify","dot-object","dot-prop","dotenv-defaults","dotenv-expand","dotenv","download-git-repo","download","downloadjs","easy-table","echarts","ee-first","ejs","element-internals-polyfill","elementtree",
                    "elliptic","ember-cli-htmlbars","emittery","emoji-regex","encodeurl","encoding","end-of-stream","enhanced-resolve","enquire.js","enquirer","entities","env-ci","env-paths","envify","error-ex","errorhandler","es5-ext","es6-symbol",
                    "esbuild-plugin-resolve","escape-html","escape-string-regexp","eslint-config-airbnb-base","eslint-config-airbnb","eslint-config-prettier","eslint-config-react-app","eslint-loader","eslint-plugin-babel","eslint-plugin-eslint-comments",
                    "eslint-plugin-filenames","eslint-plugin-jsonc","eslint-plugin-markdown","eslint-plugin-prefer-arrow","eslint-plugin-prettier","eslint-plugin-promise","eslint-plugin-react","eslint-plugin-standard","eslint-plugin-unused-imports",
                    "eslint-plugin-vue","eslint-plugin-yml","eslint","esprima","estraverse","esutils","etag","ethereumjs-abi","ethers","event-emitter","event-stream","eventemitter2","eventemitter3","events","execa","exenv","exif-js","express-async-errors",
                    "express-http-proxy","express-promise-router","express-session","express","extract-files","extract-text-webpack-plugin","extract-zip","fancy-log","fast-deep-equal","fast-equals","fast-json-parse","fast-json-stable-stringify",
                    "fast-memoize","fast-safe-stringify","fast-xml-parser","fastclick","fastify-plugin","fastify","fastq","fetch","figlet","figures","file-type","filesize","finalhandler","find-cache-dir","find-package-json","find-root","find-up","findup-sync",
                    "firebase-admin","flat","fluent-ffmpeg","focus-trap","follow-redirects","font-awesome","for-each","form-valid-js","formidable","fresh","friendly-errors-webpack-plugin","front-matter","fs-extra","fs-readdir-recursive","fs.realpath",
                    "fsevents","fstream","fuzzy","geotiff","get-port","get-stdin","get-stream","github-markdown-css","github-slugger","github-url-from-git","glob-promise","glob-to-regexp","glob","globby","gm","google-auth-library","got","graceful-fs",
                    "graphlib","gray-matter","grunt","gulp-babel","gulp-clean-css","gulp-concat","gulp-less","gulp-plumber","gulp-rename","gulp-replace","gulp-sass","gulp-sourcemaps","gulp-uglify","gulp-util","gulp-watch","gulp","gunzip-maybe",
                    "hammerjs","has-flag","has-symbols","has-yarn","has","hash-sum","hash.js","hasha","hdkey","highcharts","hoek","hosted-git-info","html-loader","html-minifier","html-to-image","html-to-react","html-webpack-plugin","htmlparser2",
                    "http-errors","http-proxy-agent","http-proxy-middleware","http-server","http-status-codes","https-proxy-agent","humanize-duration","humanize-string","humps","i","iconv-lite","idb-keyval","identity-obj-proxy","ieee754",
                    "ignore-loader","image-size","imagemanipulatorly","imagemin-optipng","imagemin","imagesloaded","immer","immutability-helper","immutable","import-fresh","import-from","import-local","imports-loader","indent-string","inflight","inherits",
                    "ini","inquirer-autocomplete-prompt","inquirer","internal-ip","interpret","intersection-observer","invariant","ioredis","ip","ipaddr.js","is-buffer","is-ci","is-docker","is-extendable","is-extglob","is-fullwidth-code-point","is-glob",
                    "is-number","is-plain-object","is-promise","is-stream","is-string","is-typedarray","is-url","is-uuid","is-valid-path","is-windows","is-wsl","is","isarray","isexe","isobject","isomorphic-fetch","isomorphic-unfetch","isomorphic-ws",
                    "isstream","itertools","javascript-state-machine","jmespath","jose","jpeg-js","jquery-hoverintent","jquery-mousewheel","jquery-ui-timepicker-addon","jquery-ui","jquery.tocify","js-base64","js-beautify","js-cookie","js-file-download",
                    "js-levenshtein","js-sha256","js-string-escape","js-yaml","jsbn","jsdoc","json-bigint","json-loader","json-query","json-schema-traverse","json-stringify-safe","json-to-pretty-yaml","jsonc-eslint-parser","jsonfile","jsonlint","jsonpath",
                    "jsonschema","jsonwebtoken","jsrsasign","jstree","jwk-to-pem","jwks-rsa","jwt-decode","jwt-simple","kafkajs","karma-sourcemap-loader","keycode","keymirror","kill-port","kind-of","klaw-sync","kleur","knex","koa-body","koa-bodyparser",
                    "koa-compose","koa-logger","koa-mount","koa-router","koa-send","koa-static","koa","latest-version","less-loader","leven","link-module-alias","link2aws","lint-staged","listr","load-json-file","loader-utils","lodash.clamp","lodash.clonedeep",
                    "lodash.debounce","lodash.get","lodash.has","lodash.isfunction","lodash.isplainobject","lodash.kebabcase","lodash.mapvalues","lodash.memoize","lodash.merge","lodash.mergewith","lodash.set","lodash.snakecase","lodash.throttle",
                    "lodash.upperfirst","lodash","log-symbols","log-update","log4js","loose-envify","lru-cache","luxon","lz-string","make-dir","markdown-it-footnote","markdown-it","marked","marker-clusterer-plus","match-sorter","md5-file","md5","mdPickers",
                    "mdurl","memory-cache","memory-fs","meow","merge-deep","merge-stream","merge2","metalsmith","method-override","methods","micromatch","microplugin","mime-types","mime","mimic-fn","mini-css-extract-plugin","mini-svg-data-uri","minilog",
                    "minimatch","minipass","mkdirp","mobile-detect","modernizr","module-alias","moment-duration-format","moment-timezone","mongodb","moo","morgan","mousetrap","mqtt","ms","mssql","multer","multiparty","mustache","mv","mysql","mysql2","mz",
                    "nan","nconf","nedb","negotiator","net","new-github-issue-url","ng-csv","ng-file-upload","ng-table","ng2-split-pane","ngx-color-picker","nock","node-cron","node-dir","node-emoji","node-fetch","node-jose","node-libs-browser","node-notifier",
                    "node-persist","node-schedule","node-uuid","nodemailer","nodemon","normalize-package-data","normalize-path","normalize.css","npm-run-all","npm-run-path","npm","npmlog","nprogress","nullthrows","number-is-nan","numeral","nyc","object-assign",
                    "object-hash","object-keys","object-path","object.pick","omggif","on-finished","on-headers","once","onetime","open","opener","opn","optimize-css-assets-webpack-plugin","ora","orderedmap","os-browserify","os-homedir","os-tmpdir","os",
                    "p-debounce","p-filter","p-limit","p-map","p-queue","p-retry","p-try","pako","papaparse","paper-chip","parse-database-url","parse-github-url","parse-link-header","parse5","parseurl","parsimmon","pascalcase","passport-custom","passport-github",
                    "passport-google-oauth20","passport-http-bearer","passport-http","passport-jwt","passport-local","passport","path-exists","path-is-absolute","path-key","path-parse","path-to-regexp","path","pg-hstore","pg","photoswipe","picomatch",
                    "picturefill","pify","pikaday","pinkie-promise","pino-pretty","pino","pkg-dir","pkg-up","plist","plugin-error","pluralize","polycalculator","polymer-redux","popper.js","portfinder","postcss-flexbugs-fixes","postcss-import","postcss-loader",
                    "postcss-url","postcss-value-parser","preact-custom-element","preact","pretty-bytes","pretty-ms","pretty","prettyjson","prismjs","process-nextick-args","progress-bar-webpack-plugin","progress","prom-client","promise-polyfill","promise-retry",
                    "promise-sequential","prompt-sync","prompt","proper-lockfile","prosemirror-commands","prosemirror-schema-list","proxy-addr","proxy-agent","proxy-from-env","ps-tree","pubsub-js","pump","punycode","pwa-helpers","q","qr-image","qrcode-terminal",
                    "qs","query-string","querystring-es3","querystring","raf","ramda","random-number-csprng","randombytes","randomly-password-generator","randomstring","range-parser","raven","raw-body","raw-loader","rc","react-app-polyfill","react-datetime",
                    "react-fast-compare","react-google-maps","react-hot-loader","react-merge-refs","react-native-animatable","react-onclickoutside","react-player","react-text-mask","read-pkg-up","read-pkg","read","readable-stream","readdirp","readline-sync",
                    "recursive-copy","recursive-readdir","redlock","redux-devtools-extension","redux-thunk","regenerator-runtime","remark-gfm","remark-parse","remark","replace-in-file","request-promise-native","request-promise","request","require-dir",
                    "require-directory","require-from-string","requireindex","resolve-cwd","resolve-from","resolve-url-loader","rfdc","rimraf","ripemd160","rollup-plugin-visualizer","rope-sequence","route-parser","run-parallel","run-sequence","safe-buffer",
                    "safer-buffer","sanitize-filename","sanitize-html","sass-loader","sax","screenfull","script-loader","scriptjs","scrollmagic","scrypt-async","seamless-immutable","seedrandom","semver-utils","semver","send","sequelize","serialize-error",
                    "serialize-javascript","serve-favicon","serve-index","serve-static","server-destroy","set-blocking","setprototypeof","sha.js","sharp","shelljs","shimmer","showdown","sifter","signal-exit","signale","simple-git","sirv-cli","slash",
                    "slick-carousel","socket.io-client","socket.io","sockjs-client","sortablejs","source-map-loader","source-map","spark-md5","spdx-expression-parse","spdx-license-ids","split","split2","sprintf-js","sqlite3","sqlstring","squire-rte","sshpk",
                    "stack-trace","stackdriver-errors-js","statuses","std-env","stoppable","store","stream-browserify","stream-buffers","stream-http","stream","string-hash","string-similarity","string-width","string_decoder","stringify-object","strip-ansi",
                    "strip-indent","strip-json-comments","stripe","striptags","style-dictionary","style-loader","style-mod","stylelint-config-prettier","stylelint-config-standard","stylelint-config-styled-components","stylelint-order","stylelint-scss","stylelint",
                    "stylus-loader","sudo-prompt","superagent","supercluster","supertest","supports-color","supports-preserve-symlinks-flag","svgo","swagger-ui-express","swfobject","swiper","systeminformation","tapable","tar-fs","tar-stream","tar","temp-dir",
                    "temp-write","temp","tempy","terminal-link","tern","terser","text-encoding","text-summarizerly","textmoji","throttle-debounce","through","through2","tiny-glob","tinycolor2","tmp-promise","tmp","toposort","touch","tough-cookie","tree-kill",
                    "ts-dedent","ts-jest","ts-loader","ts-md5","tslib","tunnel-agent","twilio","type-fest","type-is","uglify-es","uglify-js","ui-select","ulid","underscore","uniqid","universalify","unixify","unpipe","untildify","unzip","unzipper","update-notifier",
                    "update","uppercamelcase","urijs","url-join","url-loader","url-pattern","url-search-params-polyfill","url","user-home","useragent","util-deprecate","util","utils-merge","uuid","uuidv7","v8-compile-cache","validate-npm-package-license",
                    "validate-npm-package-name","varint","vary","verror","video.js","vinyl-buffer","vinyl-fs","vinyl","vm2","vscode-json-languageservice","vue-color","vue-demi","vue-multiselect","vue-style-loader","vue-template-compiler","wTools","walk",
                    "wangeditor","warning","watch","wavesurfer.js","web-activities","web-vitals","webcomponents.js","webfontloader","webpack-assets-manifest","webpack-dev-middleware","webpack-dev-server","webpack-hot-middleware","webpack-manifest-plugin",
                    "webpack-sources","webpack","websocket","whatwg-fetch","which","wicg-inert","window-or-global","winston-daily-rotate-file","wolfy87-eventemitter","word-wrap","wordcloud","wrap-ansi","wrappy","wrench","ws","xml2js","xmldom","xmlhttprequest",
                    "xtend","y18n","yaml-ast-parser","yaml","yamljs","yargs-parser","yargs","yauzl","yazl","yeoman-generator","yn","yosay","zip-dir","zlibjs","zone.js"
                ]
            }
        }
    },
    "chain": [
		{
            "predicate": {
                "type": "https://spdx.dev/Document",
                "selector": "predicates[0].data.packages.filter(pkg, pkg.name in context.packages && has(pkg.checksums) && size(pkg.checksums) > 0).map(pkg, { 'name': has(pkg.name) ? pkg.name : '', 'digest': pkg.checksums.map(checksum, { string(checksum.algorithm).lowerAscii(): dyn(checksum.checksumValue) })[0], 'uri': has(pkg.externalRefs) && size(pkg.externalRefs) > 0 ? dyn(pkg.externalRefs.filter(ref, ref.referenceType == 'purl')[0].referenceLocator) : dyn('')   })"
            }
        }
	],
    "policies": [
        {
            "id": "oss-rebuild-artifact-equivalence",
            "meta": {
                "assert_mode": "OR",
                "description": "Validate package with an OSS Rebuild ArtifactEquivalence attestation"
            },
            "context": {
                "whitelist": {
                    "required": true,
                    "default": []
                }
            },
            "identities": [
                {
                    "key": {
                        "id": "5be34774cae03891",
                        "data": "-----BEGIN PUBLIC KEY-----\nMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEXkyL5IFxz/Hg6DwUy0HBumXcMxt9\nnQSECAK6r262hPwIzjd6LpE7IPlUbwgheE87vU8EUE9tsS02MShFZGo1gg==\n-----END PUBLIC KEY-----\n"
                    }
                }
            ],
            "tenets": [
                {
                    "predicates": {
                        "types": ["https://slsa.dev/provenance/v1"]
                    },
                    "outputs": {
                        "buildDefinition": { "code": "predicates[0].data.buildDefinition.buildType" } 
                    },
                    "code": "outputs.buildDefinition == 'https://docs.oss-rebuild.dev/builds/ArtifactEquivalence@v0.1' ",
                    "assessment": {  "message": "Package {{ .Subject.Name }} build verified through ArtifactEquivalence" }
                },
                {
                   "code": " subject.name in context.whitelist ",
                    "assessment": {  "message": "Package {{ .Subject.Name }} whitelisted" }
                }
            ]
        }
    ]
 }
